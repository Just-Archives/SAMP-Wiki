<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="keywords" content="OnPlayerUpdate FR,Main Page FR,Scripting Basics FR,Server Plugins,Scripting Callbacks FR,Scripting Functions FR,Tutorials FR" />
<link rel="shortcut icon" href="../favicon.html" />
		<title>OnPlayerUpdate FR - SA-MP Wiki</title>
		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "../skins/monobook/main8f14.css?7"; /*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="../skins/common/commonPrint.css" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "../skins/monobook/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "../skins/monobook/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "../skins/monobook/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "../skins/monobook/IE70Fixes.css?1";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="../skins/common/IEFixes.js"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		<script type="text/javascript">var skin = 'monobook';var stylepath = '../skins';</script>
		<script type="text/javascript" src="../skins/common/wikibits.js"><!-- wikibits js --></script>
		<script type="text/javascript" src="../raw/gen.js"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "../raw/MediaWiki_Common.css";
@import "../raw/MediaWiki_Monobook.css";
@import "../raw/gen.css";
/*]]>*/</style>
		<!-- Head Scripts -->
			</head>
<body  class="ns-0 ltr">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 class="firstHeading">OnPlayerUpdate FR</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From SA-MP Wiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<div class="scripting" style="color: #4378A4; background-color: #FFFFFF; margin: 2px; margin-bottom: 10px;"><div align="center" style="border: 1px solid #AAAAAA; padding: 3px; padding-left: 5px;"><a href="Main_Page_FR.html" title="Main Page FR">Page d'Accueil</a> | <a href="Category_Scripting_Functions_FR.html" title="Category:Scripting Functions FR">Les Fonctions</a> | <a href="Category_Scripting_Callbacks_FR.html" title="Category:Scripting Callbacks FR">Les Callbacks</a> | <a href="Scripting_Basics_FR.html" title="Scripting Basics FR">Les bases du Scripting</a> | <a href="Server_Plugins.html" title="Server Plugins">Plugins de Serveur</a> | <a href="Category_Tutorials_FR.html" title="Category:Tutorials FR">Tutoriaux</a><br /><div style="font-size:10px;padding:0px;margin:-6px;">Ne prenez pas en compte les <b>FR</b> dans les noms</div></div></div><br />
<p><br />
<b>Description:</b><br />
</p>
<div class="description" style="padding-left:35px;">Cette callback est appelée à chaque fois qu'un client/joueur modifie son status auprès du serveur. Elle est souvent utilisée pour créer des callbacks personnalisées qui ne sont pas présentes nativement, telle que le changement de vie, d'armure ou le changement d'arme.<br /></div>
<p><br />
</p>
<div style="max-width: 750px; width:auto;">
<table style="padding: 5px; background-color: #FFEAEA; border-left: 10px solid #FCA9A9;">

<tr>
<td align="center" style="padding-right:10px; padding-left:5px; border-right:1px solid #FCA9A9;"><a href="Image_32px-Circle-style-warning.png.html" class="image" title="Image:32px-Circle-style-warning.png"><img src="../upload/5/57/32px-Circle-style-warning.png" alt="Image:32px-Circle-style-warning.png" width="32" height="32" longdesc="Image_32px-Circle-style-warning.png.html" /></a><br />
<p><strong>Notes<br />Importantes</strong>
</p>
</td><td align="left" style="padding-left:10px; padding-right:7px;"><span style="font-size:14px;">
<ul><li> Cette callback est appelée environ 30 fois par secondes, par joueur; à utiliser seulement quand vous savez exactement pourquoi.
</li><li> La fréquence à laquelle est appelée cette callback varie en fonction des joueurs, dépendant de ce que fait le joueur. La fréquence d'appel sera plus élevé quand le joueur conduira, tirera alors qu'elle sera plus basse quand le joueur sera statique.
</li></ul>
<p></span>
</p>
</td></tr></table>
</div>
<p><br />
</p>
<b>Paramètres:</b><div class="parameters" style="padding:2px; padding-left:5px; margin-left:35px; margin-top: 10px; font-family: Courier New; border-bottom: 1px solid #AAAAAA; border-right: 1px solid #AAAAAA; width: 75%; background-color: #f4f8fb">(playerid)<br /></div>
<div class="param" style="padding-left:50px;"><table><tr><td style="vertical-align:top;width:150px;font-family:'Courier New'">playerid</td><td style="vertical-align:top;">ID du joueur ayant envoyé un paquet au serveur</td></tr></table></div>
<p><br />
<b>Retourne:</b><br />
</p>
<div style="padding-left:35px;">
<ul><li> <b>0</b> - La mise à jour du joueur ne sera pas appliquée aux autres joueurs.
</li><li> <b>1</b> - Indique que la mise à jour peut être traité de façon normale et envoyé aux autres joueurs.
</li></ul>
<br /></div>
<p><br />
<b>Example: Créer votre propre callback - OnPlayerChangeWeapon(playerid, oldweapon, newweapon)</b> 
</p>
<pre class="pawn"><span style="color: #228b22; font-weight: bold;">public</span> OnPlayerUpdate<span style="color: #66cc66;">&#40;</span>playerid<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
    <span style="color: #228b22; font-weight: bold;">new</span> iCurWeap = <a href="http://wiki.sa-mp.com/wiki/GetPlayerWeapon"><span style="color: #006400;">GetPlayerWeapon</span></a><span style="color: #66cc66;">&#40;</span>playerid<span style="color: #66cc66;">&#41;</span>; <span style="color: #808080; font-style: italic;">// Retourne l'arme actuelle du joueur		</span>
    <span style="color: #4169e1;">if</span><span style="color: #66cc66;">&#40;</span>iCurWeap&nbsp;!= GetPVarInt<span style="color: #66cc66;">&#40;</span>playerid, <span style="color: #b22222;">&quot;iCurrentWeapon&quot;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #808080; font-style: italic;">// S'il l'arme à changer depuis la dernière mise à jour</span>
    <span style="color: #66cc66;">&#123;</span>
        <span style="color: #808080; font-style: italic;">// Appelons une callback nommée OnPlayerChangeWeapon</span>
        OnPlayerChangeWeapon<span style="color: #66cc66;">&#40;</span>playerid, GetPVarInt<span style="color: #66cc66;">&#40;</span>playerid, <span style="color: #b22222;">&quot;iCurrentWeapon&quot;</span><span style="color: #66cc66;">&#41;</span>, iCurWeap<span style="color: #66cc66;">&#41;</span>;
        SetPVarInt<span style="color: #66cc66;">&#40;</span>playerid, <span style="color: #b22222;">&quot;iCurrentWeapon&quot;</span>, iCurWeap<span style="color: #66cc66;">&#41;</span>;<span style="color: #808080; font-style: italic;">//Met à jour la variable arme du joueur</span>
    <span style="color: #66cc66;">&#125;</span>
    <span style="color: orange; font-weight: bold;">return</span> <span style="color: #4169e1;">1</span>; <span style="color: #808080; font-style: italic;">// Envoi de la mise à jour à tous les joueurs.</span>
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #228b22; font-weight: bold;">stock</span> OnPlayerChangeWeapon<span style="color: #66cc66;">&#40;</span>playerid, oldweapon, newweapon<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #228b22; font-weight: bold;">new</span>     s<span style="color: #66cc66;">&#91;</span><span style="color: #4169e1;">128</span><span style="color: #66cc66;">&#93;</span>,
		oWeapon<span style="color: #66cc66;">&#91;</span><span style="color: #4169e1;">24</span><span style="color: #66cc66;">&#93;</span>,
		nWeapon<span style="color: #66cc66;">&#91;</span><span style="color: #4169e1;">24</span><span style="color: #66cc66;">&#93;</span>;
&nbsp;
	<a href="http://wiki.sa-mp.com/wiki/GetWeaponName"><span style="color: #006400;">GetWeaponName</span></a><span style="color: #66cc66;">&#40;</span>oldweapon, oWeapon, <span style="color: orange; font-weight: bold;">sizeof</span><span style="color: #66cc66;">&#40;</span>oWeapon<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;
	<a href="http://wiki.sa-mp.com/wiki/GetWeaponName"><span style="color: #006400;">GetWeaponName</span></a><span style="color: #66cc66;">&#40;</span>newweapon, nWeapon, <span style="color: orange; font-weight: bold;">sizeof</span><span style="color: #66cc66;">&#40;</span>nWeapon<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;
&nbsp;
	<a href="http://wiki.sa-mp.com/wiki/format"><span style="color: #006400;">format</span></a><span style="color: #66cc66;">&#40;</span>s, <span style="color: orange; font-weight: bold;">sizeof</span><span style="color: #66cc66;">&#40;</span>s<span style="color: #66cc66;">&#41;</span>, <span style="color: #b22222;">&quot;Vous avez changé votre arme de %s à %s!&quot;</span>, oWeapon, nWeapon<span style="color: #66cc66;">&#41;</span>;
&nbsp;
	<a href="http://wiki.sa-mp.com/wiki/SendClientMessage"><span style="color: #006400;">SendClientMessage</span></a><span style="color: #66cc66;">&#40;</span>playerid, 0xFFFFFFFF, s<span style="color: #66cc66;">&#41;</span>;
<span style="color: #66cc66;">&#125;</span></pre>
<p>L'exemple si dessus montre comment vous pouvez créer facilement vos propres callbacks. (Note: vous pourriez améliorer l'exemple en réinitialisant la variable iCurrentWeapon à la connexion du joueur (OnPlayerConnect) et ne pas oublier de déclarer OnPlayerChangeWeapon (forward))
</p><p><b>Example: Suivre les changements de vie d'un joueur</b> 
</p>
<pre class="pawn"><span style="color: #228b22; font-weight: bold;">public</span> OnPlayerUpdate<span style="color: #66cc66;">&#40;</span>playerid<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #228b22; font-weight: bold;">new</span> <span style="color: orange;">Float</span>:fHealth;
&nbsp;
	<a href="http://wiki.sa-mp.com/wiki/GetPlayerHealth"><span style="color: #006400;">GetPlayerHealth</span></a><span style="color: #66cc66;">&#40;</span>playerid, fHealth<span style="color: #66cc66;">&#41;</span>;
&nbsp;
	<span style="color: #4169e1;">if</span><span style="color: #66cc66;">&#40;</span>fHealth&nbsp;!= GetPVarFloat<span style="color: #66cc66;">&#40;</span>playerid, <span style="color: #b22222;">&quot;faPlayerHealth&quot;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
	    <span style="color: #808080; font-style: italic;">// La vie du joueur a changé depuis la dernière mise à jour, c'est donc bien la mise à jour qui a été envoyée.</span>
	    <span style="color: #808080; font-style: italic;">// Vérifions s'il a perdu ou gagné de la vie (anti-cheat vie&nbsp;?&nbsp;;)) </span>
&nbsp;
	    <span style="color: #4169e1;">if</span><span style="color: #66cc66;">&#40;</span>fHealth &gt; GetPVarFloat<span style="color: #66cc66;">&#40;</span>playerid, <span style="color: #b22222;">&quot;faPlayerHealth&quot;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>
	    <span style="color: #66cc66;">&#123;</span>
	        <span style="color: #808080; font-style: italic;">/* Il a gagné de la vie! Triche? */</span>
&nbsp;
	    <span style="color: #66cc66;">&#125;</span>
	    <span style="color: #4169e1;">else</span>
	    <span style="color: #66cc66;">&#123;</span>
	        <span style="color: #808080; font-style: italic;">/* Il a perdu de la vie! */</span>
	    <span style="color: #66cc66;">&#125;</span>
&nbsp;
	    SetPVarFloat<span style="color: #66cc66;">&#40;</span>playerid, <span style="color: #b22222;">&quot;faPlayerHealth&quot;</span>, fHealth<span style="color: #66cc66;">&#41;</span>;
	<span style="color: #66cc66;">&#125;</span>
<span style="color: #66cc66;">&#125;</span></pre>
<p>Le script du dessus peut être utilisé pour détecter la triche sur la vie. Stockez la vie du joueur dans une variable lorsque vous la modifiez, de façon à voir si la valeur a été modifié par un hack (car un hack ne pourra jamais modifier les variables du serveur).
</p><div class="printfooter">
Retrieved from "<a href="http://localhost../wiki/OnPlayerUpdate_FR.html">http://localhost../wiki/OnPlayerUpdate_FR.html</a>"</div>
			<div id="catlinks"><p class='catlinks'><a href="Special_Categories.html" title="Special:Categories">Category</a>: <span dir='ltr'><a href="Category_Scripting_Callbacks_FR.html" title="Category:Scripting Callbacks FR">Scripting Callbacks FR</a></span></p></div>			<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<ul>
				 <li id="ca-nstab-main" class="selected"><a href="OnPlayerUpdate_FR.html">Article</a></li>
				 <li id="ca-talk" class="new"><a href="Talk_OnPlayerUpdate_FR.html">Discussion</a></li>
				 <li id="ca-edit"><a href="OnPlayerUpdate_FR.html">Edit</a></li>
				 <li id="ca-history"><a href="OnPlayerUpdate_FR.html">History</a></li>
		</ul>
	</div>

	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="../wiki-archive.html">Main Page</a></li>
				<li id="n-help"><a href="Help_Contents.html">Help</a></li>
			</ul>
		</div>
	</div>
	
	<div id="p-lang" class="portlet">
		<h5>In other languages</h5>
		<div class="pBody">
			<ul>
				<li class="interwiki-es"><a href="OnPlayerUpdate_ES.html">Español</a></li>
				<li class="interwiki-lt"><a href="OnPlayerUpdate_LT.html">Lietuvių</a></li>
			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="MediaWiki" /></a></div>
			<ul id="f-list">
				<li id="viewcount">This page has been accessed 897 times.</li>
				<li id="credits">This page was last modified 22:29, 10 July 2017 by SA-MP Wiki user <a href="User_Wjulien91.html" title="User:Wjulien91">Wjulien91</a>. </li>
				<li id="privacy"><a href="SA-MP_Wiki_Privacy_policy.html" title="SA-MP Wiki:Privacy policy">Privacy policy</a></li>
				<li id="about"><a href="SA-MP_Wiki_About.html" title="SA-MP Wiki:About">About SA-MP Wiki</a></li>
				<li id="disclaimer"><a href="SA-MP_Wiki_General_disclaimer.html" title="SA-MP Wiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
	<script type="text/javascript"> if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served by forum in 114.92 secs. -->
</body></html>
